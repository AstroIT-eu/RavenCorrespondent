{"createdAt":"2021-05-10T12:28:14.828","modifiedAt":"2021-08-26T15:55:35.244","createdBy":"TAS","modifiedBy":"Marco","title":"FM Service Overview (grid1)","provider":"SpringBackendServiceProvider","tags":[],"systemTags":["RESERVED_DOCUMENT","published-as-datasource","services-editor"],"name":"FM Service Overview (grid1)","type":"services-editor","saved":true,"id":"a1b8e3ab-5519-4647-9a51-c4977feb2eb2","previewId":null,"content":{"definition":{"id":"a1b8e3ab-5519-4647-9a51-c4977feb2eb2","title":"FM Service Overview (grid1)","useBaseUrl":true,"publishAsDatasource":true,"serverSideDatasource":true,"dataEntryEnabled":false,"downloadEnabled":false,"expectedResultType":"Table","validated":true,"mandatoryParameters":[],"skipOnEmptyQueryString":false,"includeRawData":false,"emptyParametersToEmptyString":false,"schema":[{"name":"date","type":"string","value":null},{"name":"nostroTemp","type":"string","value":null},{"name":"intraday","type":"boolean","value":null},{"name":"kind","type":"string","value":null},{"name":"valuePayment","type":"number","value":0},{"name":"typeKey","type":"string","value":"NOSTRO-CLEARER"},{"name":"preadvicePayment","type":"number","value":0},{"name":"projectedEndOfDayBalance","type":"number","value":0},{"name":"accountType","type":"string","value":"NOSTRO"},{"name":"nostroType","type":"string","value":"CLEARER"},{"name":"currency","type":"string","value":"EUR"},{"name":"credit","type":"number","value":0},{"name":"debit","type":"number","value":0},{"name":"taskId","type":"string","value":"1970-01-01T00:00:00.001Z"},{"name":"taskParentId","type":"string","value":"CLEARER"}],"selectCall":{"method":"Get","enabled":true,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{"datasource":{},"parameter":{},"systemParameter":{},"custom":{"result":{"fields":["items"]}}},"expectedResult":null,"syntax":"standard","code":"var myArray=toArray(custom('result','items'));\n//return myArray\n\nvar filteredCollection = _.map(myArray, function (c) {\n    return _.omit(c, ['accountTypeForecasts']);\n});\n//return filteredCollection\n\nfunction items(i){\n  if(_.size(i.accountTypeForecasts) > 0)\n  \t\t\treturn i.accountTypeForecasts;\n\n}\n\nvar arrayFigli =  _.flatten(_.filter(_.map(myArray,items),function(o){ return o != null}));\nvar arrayTOT= toArray(custom('result','items'))\n\n//return arrayFigli\n\nvar arrObject = [];\n\nvar i;\nfor (i = 0; i < arrayTOT.length; i++) {\n  //make father\n  var figli=arrayTOT[i].accountTypeForecasts\n // return figli\n  var f= { \n    \"date\": null,\n    \"nostroTemp\": null,\n    \"intraday\": null,\n    \"kind\": null,\n    \"valuePayment\": null,\n    \"typeKey\": null,\n    \"preadvicePayment\": null,\n    \"projectedEndOfDayBalance\": null,\n    \"accountType\": null,\n    \"nostroType\": null,\n    \"currency\": null,\n    \"credit\": null,\n    \"debit\": null,\n    \"taskId\": null,\n    \"taskParentId\": null\n  }\n\tvar anno = arrayTOT[i].date.substring(0,4)\n    var mese = arrayTOT[i].date.substring(5,7)\n    var giorno = arrayTOT[i].date.substring(8,10)\n\t\n  f.date= giorno + '/' + mese + '/' + anno\n  f.intraday=arrayTOT[i].intraday\n  f.kind=arrayTOT[i].kind\n  f.taskId=arrayTOT[i].date\n  \n    arrObject.push(f);\n//return arrObject \n//return arrayTOT\nvar j\nfor (j = 0; j < figli.length; j++) {\n  \n  var g= { \n    \"date\": null,\n    \"nostroTemp\": null,\n    \"intraday\": null,\n    \"kind\": null,\n    \"valuePayment\": null,\n    \"typeKey\": null,\n    \"preadvicePayment\": null,\n    \"projectedEndOfDayBalance\": null,\n    \"accountType\": null,\n    \"nostroType\": null,\n    \"currency\": null,\n    \"credit\": null,\n    \"debit\": null,\n    \"taskId\": null,\n    \"taskParentId\": null\n  }\n  \n  g.date=figli[j].nostroType\n  g.valuePayment=figli[j].valuePayment\n  g.typeKey=figli[j].typeKey\n  g.preadvicePayment=figli[j].preadvicePayment\n  g.projectedEndOfDayBalance=figli[j].projectedEndOfDayBalance\n  g.accountType=figli[j].accountType\n  g.nostroType=figli[j].nostroType\n  g.currency=figli[j].currency\n  g.credit=figli[j].credit\n  g.debit=figli[j].debit\n  g.taskId=0\n  g.taskParentId=figli[j].date\n  \n    arrObject.push(g);\n}\n}\n \n//return figli\nvar y\nfor (y = 0; y < arrObject.length; y++) {\n  if(arrObject[y].kind===null){\n    arrObject[y].taskId=y\n  }\n}\nreturn arrObject"},"headers":[],"address":{"schema":{"datasource":{},"parameter":{"take":{"id":"6d870359-3198-1b2d-543d-8721a576c527"},"skip":{"id":"a91ec4d8-7594-7562-f305-8c4737fb9d3c"},"guiSystem":{"id":"b0760e7b-0664-3afd-ad09-1564d4b374a3"},"legalEntityAccount":{"id":"75f68b04-17ce-1889-a35f-94326259524b"},"systemAccountCode":{"id":"45373f71-5239-a18a-3faa-51f9505c11be"},"legalEntity":{"id":"f571a823-3505-8877-9b25-c6a2b0459337"},"accountOwner":{"id":"e0b515c7-916b-1723-4d4d-66f6ec4de16a"},"currency":{"id":"21c36148-9bfc-b106-f809-f8565f2b9ac8"},"client":{"id":"82913dc5-d37e-9014-b31c-47585a98451d"},"dateFrom":{"id":"ad72f597-8cdf-d8e4-6266-5766b8cde2a2"},"dateTo":{"id":"1412eb1b-172a-7992-2863-c532cca3e692"}},"systemParameter":{},"custom":{"page":{"fields":[null]},"pageSize":{"fields":[null]}}},"expectedResult":null,"syntax":"web-template","code":"corrbanks/rs/forecastoverview?take=<%= parameter('take') %>&page=<%= custom('page') %>&pageSize=<%= custom('pageSize') %>&skip=<%= parameter('skip') %>&guiSystem=<%= parameter('guiSystem') %>&legalEntityAccount=<%= parameter('legalEntityAccount') %>&systemAccountCode=<%= parameter('systemAccountCode') %>&legalEntity=<%= parameter('legalEntity') %>&accountOwner=<%= parameter('accountOwner') %>&currency=<%= parameter('currency') %>&client=<%= parameter('client') %><%=(parameter('dateFrom'))?'&dateFrom='+format(new Date(parameter('dateFrom')),'yyyy-MM-dd HH:mm:ss'):''%><%=(parameter('dateTo'))?'&dateTo='+format(new Date(parameter('dateTo')),'yyyy-MM-dd HH:mm:ss'):''%>"},"type":"Select","errorBypass":{"schema":{},"expectedResult":null,"syntax":"standard"}},"insertCall":{"method":"Put","enabled":false,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Insert","errorBypass":{"schema":{},"expectedResult":null,"syntax":"standard"}},"updateCall":{"method":"Post","enabled":false,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Update","errorBypass":{"schema":{},"expectedResult":null,"syntax":"standard"}},"deleteCall":{"method":"Delete","enabled":false,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Delete","errorBypass":{"schema":{},"expectedResult":null,"syntax":"standard"}},"createCall":{"method":"Get","enabled":false,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Create","errorBypass":{"schema":{},"expectedResult":null,"syntax":"standard"}},"serverSideOptions":{"id":"c5251a29-a604-72c5-72cc-c68962eccab2","columns":[],"rows":[],"originalRows":[],"dataEntryRunTypes":[],"datasourceType":"Standard","autoRefreshEnabled":false,"autoRefreshSystem":false,"autoRefreshTime":60,"refreshOnLoad":false,"remoteSort":"","page":1,"isBusy":false,"isFiltered":false,"isServerSide":false,"hasError":false,"splitItems":[],"rowCount":100,"pageSize":10,"tags":[],"parameters":[]},"pageExp":{"schema":{"datasource":{},"parameter":{},"systemParameter":{},"custom":{"result":{"fields":[null]}}},"expectedResult":null,"syntax":"standard","code":"(custom('result')||{}).page||1;"},"pageSizeExp":{"schema":{"datasource":{},"parameter":{},"systemParameter":{},"custom":{"pageSize":{"fields":[null]}}},"expectedResult":null,"syntax":"standard","code":"custom('pageSize')"},"recordCountExp":{"schema":{"datasource":{},"parameter":{},"systemParameter":{},"custom":{"result":{"fields":[null]}}},"expectedResult":null,"syntax":"standard","code":"(custom('result')||{}).total||0;"},"sortingExp":{"schema":{},"expectedResult":null,"syntax":"standard"},"baseUrlId":"Aquarius Services","downloadExp":{"schema":{},"expectedResult":null,"syntax":"web-template"},"resultTypes":"Table"},"parameters":[{"id":"6d870359-3198-1b2d-543d-8721a576c527","name":"take","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"number","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":10},{"id":"63084156-e4b9-1216-efe8-2ff5a839143b","name":"page","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"number","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":1},{"id":"cbeea642-ac9c-c6f2-da26-a3239e1879d1","name":"pageSize","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"number","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":10},{"id":"a91ec4d8-7594-7562-f305-8c4737fb9d3c","name":"skip","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"number","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":0},{"id":"b0760e7b-0664-3afd-ad09-1564d4b374a3","name":"guiSystem","description":"","systemType":"","defaultValue":"CORR","lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"CORR"},{"id":"75f68b04-17ce-1889-a35f-94326259524b","name":"legalEntityAccount","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":""},{"id":"21c36148-9bfc-b106-f809-f8565f2b9ac8","name":"currency","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[]},{"id":"e0b515c7-916b-1723-4d4d-66f6ec4de16a","name":"accountOwner","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[]},{"id":"45373f71-5239-a18a-3faa-51f9505c11be","name":"systemAccountCode","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[]},{"id":"f571a823-3505-8877-9b25-c6a2b0459337","name":"legalEntity","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":""},{"id":"82913dc5-d37e-9014-b31c-47585a98451d","name":"client","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[]},{"id":"ad72f597-8cdf-d8e4-6266-5766b8cde2a2","name":"dateFrom","description":"","systemType":"","defaultValue":"1970-01-01T00:00:00.000Z","lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"date","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"2021-08-25T22:00:00.000Z"},{"id":"1412eb1b-172a-7992-2863-c532cca3e692","name":"dateTo","description":"","systemType":"","defaultValue":"1970-01-01T00:00:00.000Z","lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"date","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"2021-08-25T22:00:00.000Z"},{"id":"18a5fb62-3518-444d-1758-a69a17ebc44f","name":"category","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[]}]}}