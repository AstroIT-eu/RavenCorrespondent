{"createdAt":"2021-05-24T17:40:05.695","modifiedAt":"2021-11-02T15:49:08.102","createdBy":"TAS","modifiedBy":"TAS","title":"SE - Forecast Monitor Currency - Overview","provider":"SpringBackendServiceProvider","tags":[],"systemTags":["published-as-datasource","RESERVED_DOCUMENT","services-editor"],"name":"SE - Forecast Monitor Currency - Overview","type":"services-editor","saved":true,"id":"5cd6a7c9-d742-40e0-9535-8c0fdc42e68e","previewId":null,"content":{"definition":{"id":"5cd6a7c9-d742-40e0-9535-8c0fdc42e68e","title":"SE - Forecast Monitor Currency - Overview","useBaseUrl":true,"publishAsDatasource":true,"serverSideDatasource":true,"dataEntryEnabled":false,"downloadEnabled":false,"expectedResultType":"Table","validated":true,"mandatoryParameters":[],"skipOnEmptyQueryString":false,"includeRawData":false,"emptyParametersToEmptyString":false,"schema":[{"name":"kind","type":"string","value":null},{"name":"date","type":"date","value":"2021-09-23"},{"name":"opening","type":"number","value":0},{"name":"projected","type":"number","value":10153553},{"name":"current","type":"number","value":10153553},{"name":"currency","type":"string","value":""},{"name":"taskId","type":"string","value":279},{"name":"taskParentId","type":"string","value":"ZAR"},{"name":"description","type":"string","value":"ZAR 23/09/2021"},{"name":"currencyWB","type":"string","value":"ZAR"},{"name":"totalPaymentsUnmatched","type":"string"},{"name":"goldProjected","type":"number"},{"name":"treeOpening","type":"string","value":null},{"name":"treeCurrent","type":"string","value":null},{"name":"treeProjected","type":"string","value":null}],"selectCall":{"method":"Get","enabled":true,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{"datasource":{},"parameter":{},"systemParameter":{},"custom":{"result":{"fields":[null]}}},"expectedResult":null,"syntax":"standard","code":"var myArray = custom('result');\nconsole.log(\"Printing myArray\", myArray)\n\nfunction items(i){\n  if(_.size(i.dataCurrency) > 0)\n  \t\t\treturn i.dataCurrency;\n\n}\n\nvar arrayFigli =  _.flatten(_.filter(_.map(myArray,items),function(o){ return o != null}));\nvar arrayTOT= custom('result');\n\n//return arrayFigli\n\nvar arrObject = [];\n\nvar i;\nfor (i = 0; i < arrayTOT.length; i++) {\n    //make father\n    var figli = arrayTOT[i].dataCurrency\n    // return figli\n    var f = {\n        \"kind\": null,\n        \"date\": null,\n        \"opening\": null,\n        \"projected\": null,\n        \"current\": null,        \n        \"currency\": null,\n        \"taskId\": null,\n        \"taskParentId\": null,\n      \t\"description\": null,\n      \t\"currencyWB\":null,\n        \"totalPaymentsUnmatched\": null,\n        \"goldProjected\": null,\n        \"treeOpening\": null,\n        \"treeCurrent\": null,\n        \"treeProjected\": null,\n    }\n\n    f.kind = arrayTOT[i].kind;\n    f.currency = arrayTOT[i].currency;\n    f.taskId = arrayTOT[i].currency;\n    f.currencyWB=arrayTOT[i].currency;\n\n  \n    arrObject.push(f);\n\n    var j\n    for (j = 0; j < figli.length; j++) {\n        var g = { \n            \"kind\": null,\n            \"date\": null,\n            \"opening\": null,\n            \"projected\": null,\n            \"current\": null,         \n            \"currency\": null,\n            \"currencyWB\": null,\n            \"taskId\": null,\n            \"taskParentId\": null,\n          \t\"description\": null,\n            \"treeOpening\": null,\n            \"treeCurrent\": null,\n            \"treeProjected\": null,\n        }\n        \n        g.date = figli[j].date\n        g.opening = parseFloat(figli[j].opening)\n        g.current = parseFloat(figli[j].current)\n        g.projected = parseFloat(figli[j].projected)\n        g.taskId = 0\n        g.taskParentId = figli[j].currency\n      \tg.description = figli[j].currency + ' ' + format(new Date(figli[j].date), 'dd/MM/yyy')\n\t\tg.currencyWB=arrayTOT[i].currency\n        g.treeOpening = parseFloat(figli[j].opening)\n        g.treeCurrent = parseFloat(figli[j].current)\n        g.treeProjected = parseFloat(figli[j].projected)\n        g.goldProjected= parseInt(figli[j].goldProjected)\n        g.totalPaymentsUnmatched= figli[j].totalPaymentsUnmatched\n      \n        arrObject.push(g);\n    }\n}\n \n//return figli\nvar y\nfor (y = 0; y < arrObject.length; y++) {\n  if (arrObject[y].kind === null){\n    arrObject[y].taskId = y\n  }\n}\n\nconsole.log(arrObject)\nreturn arrObject;"},"headers":[],"address":{"schema":{"datasource":{},"parameter":{"businessDate":{"id":"6d8a9571-1686-1e0b-1711-10b9fc672b68"},"interval":{"id":"a9760eb2-8468-e785-9960-f89190b818fb"},"take":{"id":"ca6a03dd-96da-5131-aa12-3d3dc1e55d36"},"skip":{"id":"a6a3d33c-163c-ac58-14fa-934adcbd11b5"},"dateFrom":{"id":"84ec8369-6b97-f8e9-472f-02a8475111d4"},"dateTo":{"id":"8dc52d4b-cbe9-1672-211c-787ce8a954cb"},"currency":{"id":"b3971a3b-3e5a-4630-b6ab-d91ced0dc854"},"currencyGroup":{"id":"09654730-450e-3738-d507-59d1e329a0cb"},"correspondentBank":{"id":"52abdb03-c645-1384-824a-cd68a954791e"},"internalAccountCode":{"id":"a82aa265-0627-527e-405c-89ca3697c05b"},"externalAccountCode":{"id":"a9df1d82-56b8-aeae-f40f-b37ddac710a4"}},"systemParameter":{},"custom":{"page":{"fields":[null]},"pageSize":{"fields":[null]},"remoteSort":{"fields":[null]}}},"expectedResult":null,"syntax":"web-template","code":"foundation/rs/forecastoverview/currencyoverview?businessDate=<%= format(parameter('businessDate'), 'yyyy-MM-dd') %>&interval=<%= parameter('interval') %>&take=<%= parameter('take') %>&page=<%= custom('page') %>&pageSize=<%= custom('pageSize') %>&skip=<%= parameter('skip') %><%=(parameter('dateFrom'))?'&dateFrom='+format(new Date(parameter('dateFrom')),'yyyy-MM-dd HH:mm:ss'):''%><%=(parameter('dateTo'))?'&dateTo='+format(new Date(parameter('dateTo')),'yyyy-MM-dd HH:mm:ss'):''%><%=(parameter('currency') && parameter('currency').trim().length>0)?'&currency='+encodeURIComponent(parameter('currency')):''%><%=(parameter('currencyGroup') && parameter('currencyGroup').trim().length>0)?'&currencyGroup='+encodeURIComponent(parameter('currencyGroup')):''%>&correspondentBank=<%= parameter('correspondentBank') %>&internalAccountCode=<%= parameter('internalAccountCode') %>&externalAccountCode=<%= parameter('externalAccountCode') %>&<%= encodeAquariusSortParams(custom('remoteSort')) %>"},"type":"Select","errorBypass":{"schema":{"datasource":{},"parameter":{},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"return []"}},"insertCall":{"method":"Put","enabled":false,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Insert","errorBypass":{"schema":{},"expectedResult":null,"syntax":"standard"}},"updateCall":{"method":"Post","enabled":false,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Update","errorBypass":{"schema":{},"expectedResult":null,"syntax":"standard"}},"deleteCall":{"method":"Delete","enabled":false,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Delete","errorBypass":{"schema":{},"expectedResult":null,"syntax":"standard"}},"createCall":{"method":"Get","enabled":false,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Create","errorBypass":{"schema":{},"expectedResult":null,"syntax":"standard"}},"serverSideOptions":{"id":"4e332b56-2b28-a0d5-7d97-3fd48c748b7b","columns":[],"rows":[],"originalRows":[],"dataEntryRunTypes":[],"datasourceType":"Standard","autoRefreshEnabled":false,"autoRefreshSystem":false,"autoRefreshTime":60,"refreshOnLoad":false,"remoteSort":"","page":1,"isBusy":false,"isFiltered":false,"isServerSide":false,"hasError":false,"splitItems":[],"rowCount":100,"pageSize":10,"tags":[],"parameters":[]},"pageExp":{"schema":{"datasource":{},"parameter":{},"systemParameter":{},"custom":{"result":{"fields":[null]}}},"expectedResult":null,"syntax":"standard","code":"(custom('result')||{}).page||1;"},"pageSizeExp":{"schema":{"datasource":{},"parameter":{},"systemParameter":{},"custom":{"pageSize":{"fields":[null]}}},"expectedResult":null,"syntax":"standard","code":"custom('pageSize')"},"recordCountExp":{"schema":{"datasource":{},"parameter":{},"systemParameter":{},"custom":{"result":{"fields":[null]}}},"expectedResult":null,"syntax":"standard","code":"(custom('result')||{}).total||0;"},"sortingExp":{"schema":{},"expectedResult":null,"syntax":"standard"},"downloadExp":{"schema":{},"expectedResult":null,"syntax":"web-template"},"baseUrlId":"Aquarius Services","resultTypes":"Table"},"parameters":[{"id":"e6469e94-d4a9-8018-235e-bd9c34120075","name":"pageSize","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"10","expression":{"schema":{},"expectedResult":null,"syntax":"standard"}},{"id":"b4d87a18-c4a2-a584-f334-21644077c5d8","name":"page","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"1","expression":{"schema":{},"expectedResult":null,"syntax":"standard"}},{"id":"ca6a03dd-96da-5131-aa12-3d3dc1e55d36","name":"take","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"10","expression":{"schema":{},"expectedResult":null,"syntax":"standard"}},{"id":"a6a3d33c-163c-ac58-14fa-934adcbd11b5","name":"skip","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"0","expression":{"schema":{},"expectedResult":null,"syntax":"standard"}},{"id":"6d8a9571-1686-1e0b-1711-10b9fc672b68","name":"businessDate","description":"","systemType":"","defaultValue":"1970-01-01T00:00:00.000Z","lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"date","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"2021-09-19T22:00:00.000Z","expression":{"schema":{},"expectedResult":null,"syntax":"standard"}},{"id":"a9760eb2-8468-e785-9960-f89190b818fb","name":"interval","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"DAILY","expression":{"schema":{},"expectedResult":null,"syntax":"standard"}},{"id":"b3971a3b-3e5a-4630-b6ab-d91ced0dc854","name":"currency","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"EUR","expression":{"schema":{},"expectedResult":null,"syntax":"standard"}},{"id":"09654730-450e-3738-d507-59d1e329a0cb","name":"currencyGroup","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"","expression":{"schema":{},"expectedResult":null,"syntax":"standard"}},{"id":"52abdb03-c645-1384-824a-cd68a954791e","name":"correspondentBank","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"expression":{"schema":{},"expectedResult":null,"syntax":"standard"}},{"id":"a82aa265-0627-527e-405c-89ca3697c05b","name":"internalAccountCode","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"expression":{"schema":{},"expectedResult":null,"syntax":"standard"}},{"id":"a9df1d82-56b8-aeae-f40f-b37ddac710a4","name":"externalAccountCode","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"expression":{"schema":{},"expectedResult":null,"syntax":"standard"}},{"id":"84ec8369-6b97-f8e9-472f-02a8475111d4","name":"dateFrom","description":"","systemType":"","defaultValue":"1970-01-01T00:00:00.000Z","lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"date","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"2021-09-19T22:00:00.000Z","expression":{"schema":{},"expectedResult":null,"syntax":"standard"}},{"id":"8dc52d4b-cbe9-1672-211c-787ce8a954cb","name":"dateTo","description":"","systemType":"","defaultValue":"1970-01-01T00:00:00.000Z","lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"date","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"2021-09-19T22:00:00.000Z","expression":{"schema":{},"expectedResult":null,"syntax":"standard"}},{"name":""}]}}