{"createdAt":"2021-05-18T12:12:49.308","modifiedAt":"2021-07-02T16:14:39.735","createdBy":"TAS","modifiedBy":"TAS","title":"SE - CAT_2 -  Payment Categories","provider":"ServicesEditorBackendServiceProvider","tags":["Raven service"],"systemTags":["published-as-datasource","services-editor","RESERVED_DOCUMENT"],"name":"SE - CAT_2 -  Payment Categories","type":"services-editor","saved":false,"id":"2728aa19-1ac9-43c8-b66b-ad348f97059f","previewId":null,"content":{"definition":{"id":"2728aa19-1ac9-43c8-b66b-ad348f97059f","title":"SE - CAT_2 -  Payment Categories","useBaseUrl":true,"publishAsDatasource":true,"serverSideDatasource":false,"dataEntryEnabled":false,"downloadEnabled":false,"expectedResultType":"Table","validated":false,"mandatoryParameters":[],"skipOnEmptyQueryString":false,"includeRawData":false,"schema":[{"name":"settledTotalAmountDebit","type":"number","value":0},{"name":"unprocessedTotalAmountCredit","type":"number","value":0},{"name":"settledTotalAmountCredit","type":"number","value":0},{"name":"unprocessedTotalAmount","type":"number","value":0},{"name":"kind","type":"string","value":"subcategoryresource#list"},{"name":"pendingTotalAmountDebit","type":"number","value":0},{"name":"payments","type":"object","value":[]},{"name":"forecastTotalAmountCredit","type":"number","value":0},{"name":"pendingTotalAmount","type":"number","value":0},{"name":"forecastTotalAmount","type":"number","value":0},{"name":"unprocessedTotalAmountDebit","type":"number","value":0},{"name":"pendingTotalAmountCredit","type":"number","value":0},{"name":"settledTotalAmount","type":"number","value":0},{"name":"forecastTotalAmountDebit","type":"number","value":0}],"selectCall":{"method":"Get","enabled":true,"serverSide":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{"datasource":{},"parameter":{},"systemParameter":{},"custom":{"result":{"fields":["items"]}}},"expectedResult":null,"syntax":"standard","code":"//EXTENDED\nvar myArray=toArray(custom('result','items'));\n\n\nvar filteredCollection = _.map(myArray, function (c) {\n    return _.omit(c, ['accountTypeForecasts']);\n});\n//return filteredCollection\n\nfunction items(i){\n  if(_.size(i.accountTypeForecasts) > 0)\n  \t\t\treturn i.accountTypeForecasts;\n\n}\n\nvar arrayFigli =  _.flatten(_.filter(_.map(myArray,items),function(o){ return o != null}));\nvar arrayTOT= toArray(custom('result','items'))\n\n//return arrayFigli\n\nvar arrObject = [];\n\nvar i;\nfor (i = 0; i < arrayTOT.length; i++) {\n  //make father\n  var figli=arrayTOT[i].accountTypeForecasts\n // return figli\n  var f= { \n    \"settledTotalAmountDebit\": null,\n    \"unprocessedTotalAmountCredit\": null,\n    \"settledTotalAmountCredit\": null,\n    \"unprocessedTotalAmount\": null,\n    \"kind\": null,\n    \"pendingTotalAmountDebit\": null,\n    \"payments\": [],\n    \"forecastTotalAmountCredit\": null,\n    \"pendingTotalAmount\": null,\n    \"forecastTotalAmount\": null,\n    \"unprocessedTotalAmountDebit\": null,\n    \"pendingTotalAmountCredit\": null,\n    \"settledTotalAmount\": null,\n    \"forecastTotalAmountDebit\": null,\n    \"taskId\": null,\n    \"taskParentId\": null\n  }\n  f.date=arrayTOT[i].date\n  f.intraday=arrayTOT[i].intraday\n  f.kind=arrayTOT[i].kind\n  f.taskId=arrayTOT[i].date\n  \n    arrObject.push(f);\n//return arrObject \n//return arrayTOT\nvar j\nfor (j = 0; j < figli.length; j++) {\n  \n  var g= { \n    \"settledTotalAmountDebit\": null,\n    \"unprocessedTotalAmountCredit\": null,\n    \"settledTotalAmountCredit\": null,\n    \"unprocessedTotalAmount\": null,\n    \"kind\": null,\n    \"pendingTotalAmountDebit\": null,\n    \"payments\": [],\n    \"forecastTotalAmountCredit\": null,\n    \"pendingTotalAmount\": null,\n    \"forecastTotalAmount\": null,\n    \"unprocessedTotalAmountDebit\": null,\n    \"pendingTotalAmountCredit\": null,\n    \"settledTotalAmount\": null,\n    \"forecastTotalAmountDebit\": null,\n    \"taskId\": null,\n    \"taskParentId\": null\n  }\n  \n  g.settledTotalAmountDebit=figli[j].settledTotalAmountDebit\n  g.unprocessedTotalAmountCredit=figli[j].unprocessedTotalAmountCredit\n  g.settledTotalAmountCredit=figli[j].settledTotalAmountCredit\n  g.unprocessedTotalAmount=figli[j].unprocessedTotalAmount\n  g.kind=figli[j].kind\n  g.pendingTotalAmountDebit=figli[j].pendingTotalAmountDebit\n  g.forecastTotalAmountCredit=figli[j].forecastTotalAmountCredit\n  g.unprocessedTotalAmountDebit=figli[j].unprocessedTotalAmountDebit\n  g.pendingTotalAmountCredit=figli[j].pendingTotalAmountCredit\n  g.settledTotalAmount=figli[j].settledTotalAmount\n  g.forecastTotalAmountDebit=figli[j].forecastTotalAmountDebit\n  g.taskId=0\n  g.taskParentId=figli[j].date\n  \n    arrObject.push(g);\n}\n}\n \n//return figli\nvar y\nfor (y = 0; y < arrObject.length; y++) {\n  if(arrObject[y].kind===null){\n    arrObject[y].taskId=y\n  }\n}\nreturn arrObject"},"headers":[],"address":{"schema":{"datasource":{},"parameter":{"bicParticipant":{"id":"e3da3ab5-3d91-b810-ea5a-801059ef7ac3"},"codCurrency":{"id":"f48ef913-12d3-695a-7393-ac8428383c50"},"codIntCategory":{"id":"87f53114-c675-b4a4-7fdd-1bd67ed2e683"},"codService":{"id":"56d86e38-529d-197a-84a9-578f69f6aed5"},"counterpart":{"id":"e65da33a-86a4-6043-d73b-3676718af83e"},"dateFrom":{"id":"cb35e891-66a0-3b7d-c1c9-d378484c127d"},"dateTo":{"id":"573467c3-461e-9318-37ce-dcc18e6144ed"},"idAccount":{"id":"16d35b58-fa42-6830-c98a-5e3c1ae36a14"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"web-template","code":"foundation/rs/paymentcategories?bicParticipant=<%= parameter('bicParticipant') %>&codCurrency=<%= parameter('codCurrency') %>&codIntCategory=<%= parameter('codIntCategory') %>&codService=<%= parameter('codService') %>&counterpart=<%= parameter('counterpart') %>&dateFrom=<%= format(parameter('dateFrom'), 'yyyy-MM-dd') %>&dateTo=<%= format(parameter('dateTo'), 'yyyy-MM-dd') %>&idAccount=<%= parameter('idAccount') %>"},"type":"Select"},"insertCall":{"method":"Put","enabled":false,"serverSide":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Insert"},"updateCall":{"method":"Post","enabled":false,"serverSide":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Update"},"deleteCall":{"method":"Delete","enabled":false,"serverSide":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Delete"},"createCall":{"method":"Get","enabled":false,"serverSide":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Create"},"serverSideOptions":{"id":"7c050860-c712-b7c0-11da-6151632ad2c1","columns":[],"rows":[],"originalRows":[],"dataEntryRunTypes":[],"datasourceType":"Standard","autoRefreshEnabled":false,"autoRefreshSystem":false,"autoRefreshTime":60,"remoteSort":"","page":1,"isBusy":false,"isFiltered":false,"isServerSide":false,"hasError":false,"splitItems":[],"rowCount":100,"pageSize":10,"tags":[],"parameters":[]},"pageExp":{"schema":{},"expectedResult":null,"syntax":"standard"},"pageSizeExp":{"schema":{},"expectedResult":null,"syntax":"standard"},"recordCountExp":{"schema":{},"expectedResult":null,"syntax":"standard"},"sortingExp":{"schema":{},"expectedResult":null,"syntax":"standard"},"downloadExp":{"schema":{},"expectedResult":null,"syntax":"web-template"},"baseUrlId":"Aquarius Services"},"parameters":[{"id":"56d86e38-529d-197a-84a9-578f69f6aed5","name":"codService","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"CORR"},{"id":"e3da3ab5-3d91-b810-ea5a-801059ef7ac3","name":"bicParticipant","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[]},{"id":"f48ef913-12d3-695a-7393-ac8428383c50","name":"codCurrency","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"EUR"},{"id":"87f53114-c675-b4a4-7fdd-1bd67ed2e683","name":"codIntCategory","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[]},{"id":"e65da33a-86a4-6043-d73b-3676718af83e","name":"counterpart","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[]},{"id":"cb35e891-66a0-3b7d-c1c9-d378484c127d","name":"dateFrom","description":"","systemType":"","defaultValue":"1970-01-01T00:00:00.000Z","lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"date","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"2016-12-31T23:00:00.000Z"},{"id":"573467c3-461e-9318-37ce-dcc18e6144ed","name":"dateTo","description":"","systemType":"","defaultValue":"1970-01-01T00:00:00.000Z","lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"date","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"2021-06-16T22:00:00.000Z"},{"id":"16d35b58-fa42-6830-c98a-5e3c1ae36a14","name":"idAccount","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[]}]}}