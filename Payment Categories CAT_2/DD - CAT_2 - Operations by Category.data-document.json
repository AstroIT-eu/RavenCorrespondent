{"createdAt":"2021-07-01T13:03:39.985","modifiedAt":"2021-10-12T15:05:47.459","createdBy":"TAS","modifiedBy":"TAS","title":"DD - CAT_2 - Operations by Category","provider":"SpringBackendServiceProvider","tags":[],"systemTags":[],"name":"DD - CAT_2 - Operations by Category","type":"data-document","saved":true,"id":"5c7e398b-0751-f756-c25a-85649e47b212","previewId":null,"content":{"id":"5c7e398b-0751-f756-c25a-85649e47b212","title":"DD - CAT_2 - Operations by Category","parentProviders":[{"title":"SE - CAT_2 - Operations by Category","id":"cbfba75a-daef-454f-ad0e-77663cb65cb5","provider":"ServicesEditorBackendServiceProvider","bindings":[{"id":"d4dc2e51-3b8e-cb1c-7556-b8fb3e5e69b4","target":"71c4611b-9beb-6e26-78e1-87a5beb555c8","name":"bicParticipant","targetDesc":"bicParticipant","source":{"schema":{"datasource":{},"parameter":{"bicParticipant":{"id":"ca358917-cb52-4f34-9de3-a141dab3b466"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('bicParticipant')"}},{"id":"1dec6a6c-8be3-661e-1da4-8b9e3d3a489c","target":"b1c3c2e1-d39a-af86-285d-b0a2ca387612","name":"codCurrency","targetDesc":"codCurrency","source":{"schema":{"datasource":{},"parameter":{"codCurrency":{"id":"506cddb0-667b-400d-968d-484f5b06d85e"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('codCurrency')"}},{"id":"07145af8-dc73-8c58-5e8d-3407c68baccd","target":"c5946bb2-6bd4-ca8e-8eb2-944496034b32","name":"codIntCategory","targetDesc":"codIntCategory","source":{"schema":{"datasource":{},"parameter":{"codIntCategory":{"id":"e6421c49-025f-40a9-b927-c238d5fe0fbf"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('codIntCategory')"}},{"id":"6b3acc94-c5d7-e30f-ec93-ad56da1ae34c","target":"a913b82b-ccd5-8786-95a0-51d9df6477e0","name":"codService","targetDesc":"codService","source":{"schema":{"datasource":{},"parameter":{"codService":{"id":"473e3c9a-f8c8-4f07-90a4-75e2d48dab8c"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('codService')"}},{"id":"a409ca93-2543-eca9-1496-96bb38aa0fc2","target":"0f5d2b81-7726-9cef-6d77-24a63ec3c1f3","name":"counterpart","targetDesc":"counterpart","source":{"schema":{"datasource":{},"parameter":{"counterpart":{"id":"3ee72ee6-fd47-482b-acb8-6e11f38f5f07"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('counterpart')"}},{"id":"4707cdd0-2638-33a5-18cb-49200b9868be","target":"d4bb1e25-c343-2bdd-5ebd-ddf4bfd81d9e","name":"dateFrom","targetDesc":"dateFrom","source":{"schema":{"datasource":{},"parameter":{"dateFrom":{"id":"91549cf8-9cf9-45df-931c-7b71c81077f7"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('dateFrom')"}},{"id":"b1fcb7d3-5a70-cf5e-e72a-b058e42eff2e","target":"ee9c4fb4-4a4c-518a-d254-e0e52b8e775d","name":"dateTo","targetDesc":"dateTo","source":{"schema":{"datasource":{},"parameter":{"dateTo":{"id":"496cb79f-f923-477b-9a08-fe9ee6c84a96"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('dateTo')"}},{"id":"8d6b962e-38d9-a9b1-a2c6-6dcb8833c67d","target":"d7154a38-626c-b8c3-9b55-9884e7ac9c93","name":"idAccount","targetDesc":"idAccount","source":{"schema":{"datasource":{},"parameter":{"idAccount":{"id":"b3e397b0-983b-47ee-9c84-2918233a47db"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('idAccount')"}},{"id":"bf2b110f-19a2-35f5-70ad-cc175a512516","target":"6869fad4-237b-80a2-1e87-d6bb852dc4b2","name":"codIntSubCategory","targetDesc":"codIntSubCategory","source":{"schema":{"datasource":{},"parameter":{"codIntSubCategory":{"id":"58bf64b4-e012-46ca-80d5-f962fb592a93"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('codIntSubCategory')"}}]},{"title":"SE - CAT_2 - Subcategories by Category","id":"bed44305-19e2-4486-9007-47801f7b6e8f","provider":"ServicesEditorBackendServiceProvider","bindings":[{"id":"5a6ee81b-976b-e413-763d-80844110e864","target":"bb6cf7c1-ad16-2cfd-f3d1-3ace3df344ca","name":"codIntCategory","targetDesc":"codIntCategory","source":{"schema":{"datasource":{},"parameter":{"codIntCategory":{"id":"e6421c49-025f-40a9-b927-c238d5fe0fbf"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('codIntCategory')"}},{"id":"53e3ad00-90be-33fd-36cf-4f3d53984a03","target":"da7cc1a2-59cf-71a5-8444-bd45da7527b9","name":"codService","targetDesc":"codService","source":{"schema":{"datasource":{},"parameter":{"codService":{"id":"473e3c9a-f8c8-4f07-90a4-75e2d48dab8c"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('codService')"}},{"id":"4ae65240-cd78-d741-c195-ea4aaa4a8c04","target":"b21d1eb6-3929-4934-dad9-8c99dc342142","name":"codCurrency","targetDesc":"codCurrency","source":{"schema":{"datasource":{},"parameter":{"codCurrency":{"id":"506cddb0-667b-400d-968d-484f5b06d85e"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('codCurrency')"}},{"id":"4e030633-a168-0a15-7671-b4a2d6d534a4","target":"adec513c-be16-6a7e-495a-796d22a561ab","name":"bicParticipant","targetDesc":"bicParticipant","source":{"schema":{"datasource":{},"parameter":{"bicParticipant":{"id":"ca358917-cb52-4f34-9de3-a141dab3b466"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('bicParticipant')"}},{"id":"accd0c5b-ec1e-8398-9476-ebbc64157036","target":"44de3638-e651-7199-cb31-67101e04190b","name":"counterpart","targetDesc":"counterpart","source":{"schema":{"datasource":{},"parameter":{"counterpart":{"id":"3ee72ee6-fd47-482b-acb8-6e11f38f5f07"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('counterpart')"}},{"id":"0e38e985-b249-94e2-fd48-daedb193ae2a","target":"51716519-fca9-6816-3190-d130b850713c","name":"dateFrom","targetDesc":"dateFrom","source":{"schema":{"datasource":{},"parameter":{"dateFrom":{"id":"91549cf8-9cf9-45df-931c-7b71c81077f7"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('dateFrom')"}},{"id":"5e9780e9-be51-74c8-c23b-463bb1ab86bb","target":"60b49e39-91cb-6e9c-253f-72085c0cd9e1","name":"dateTo","targetDesc":"dateTo","source":{"schema":{"datasource":{},"parameter":{"dateTo":{"id":"496cb79f-f923-477b-9a08-fe9ee6c84a96"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('dateTo')"}},{"id":"fc56a8cf-0573-5213-e4a1-3b465db81337","target":"71be86e6-a8e5-d081-3923-ee998cbc55e5","name":"idAccount","targetDesc":"idAccount","source":{"schema":{"datasource":{},"parameter":{"idAccount":{"id":"b3e397b0-983b-47ee-9c84-2918233a47db"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('idAccount')"}},{"id":"a64ca5c6-8156-9377-c521-1dee94c8ed15","target":"bd977af0-6d2c-b496-a7d4-76948b2b4699","name":"codIntSubCategory","targetDesc":"codIntSubCategory","source":{"schema":{"datasource":{},"parameter":{"codIntSubCategory":{"id":"58bf64b4-e012-46ca-80d5-f962fb592a93"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"standard","code":"parameter('codIntSubCategory')"}}]}],"parts":[{"id":"68e029bd-bc9c-dce2-6328-3ff7987b3cc2","name":"DP - CAT_2","expression":{"schema":{"datasource":{},"parameter":{},"systemParameter":{},"custom":{"SE - CAT_2 - Operations by Category":{"fields":[null]},"SE - CAT_2 - Subcategories by Category":{"fields":[null]}}},"expectedResult":null,"syntax":"standard","code":"var catObject = custom('SE - CAT_2 - Operations by Category').payments\nvar subObject = custom('SE - CAT_2 - Subcategories by Category').payments\n\nvar arrObject = [];\nvar i;\n\nfor(i = 0; i < catObject.length; i++) {\n    var c = {\n        \"unprocessedDebitCounter\": null,\n        \"pendingDebitCounter\": null,\n        \"pendingAmountCredit\": null,\n        \"forecastCreditCounter\": null,\n        \"kind\": null,\n        \"settledAmountDebit\": null,\n        \"unprocessedCreditCounter\": null,\n        \"unprocessedAmountCredit\": null,\n        \"codIntCategory\": null,\n        \"settledAmountCredit\": null,\n        \"pendingAmountDebit\": null,\n        \"subCategoryDescription\": null,\n        \"idCategory\": null,\n        \"pendingCreditCounter\": null,\n        \"categoryDescription\": null,\n        \"forecastAmountCredit\": null,\n        \"settledDebitCounter\": null,\n        \"forecastAmountDebit\": null,\n        \"codCategory\": null,\n        \"codSubCategory\": null,\n        \"codAccountService\": null,\n        \"unprocessedAmountDebit\": null,\n        \"settledCreditCounter\": null,\n        \"forecastDebitCounter\": null,\n        \"category\": null,\n        \"totalCategoryAmountCredit\": null,\n        \"totalCategoryAmountDebit\": null,\n        \"taskId\": null,\n        \"taskParentId\": null,\n    }\n\n    var cat = catObject[i].categoryDescription;\n    var sumCredit = catObject[i].settledAmountCredit + catObject[i].pendingAmountCredit + catObject[i].forecastAmountCredit + catObject[i].unprocessedAmountCredit;\n    var sumDebit = catObject[i].settledAmountDebit + catObject[i].pendingAmountDebit + catObject[i].forecastAmountDebit + catObject[i].unprocessedAmountDebit;\n\n    if (cat === 'net') {\n      sumDebit = null;\n    }\n    \n    c.unprocessedDebitCounter= catObject[i].unprocessedDebitCounter\n    c.pendingDebitCounter= catObject[i].pendingDebitCounter\n    c.pendingAmountCredit= catObject[i].pendingAmountCredit\n    c.forecastCreditCounter= catObject[i].forecastCreditCounter\n    c.kind= catObject[i].kind\n    c.settledAmountDebit= catObject[i].settledAmountDebit\n    c.unprocessedCreditCounter= catObject[i].unprocessedCreditCounter\n    c.unprocessedAmountCredit= catObject[i].unprocessedAmountCredit\n    c.codIntCategory= catObject[i].codIntCategory\n    c.settledAmountCredit= catObject[i].settledAmountCredit\n    c.pendingAmountDebit= catObject[i].pendingAmountDebit\n    c.subCategoryDescription= catObject[i].subCategoryDescription\n    c.idCategory= catObject[i].idCategory\n    c.pendingCreditCounter= catObject[i].pendingCreditCounter\n    c.categoryDescription= cat === null ? 'Total' : cat === 'net' ? 'Net Amount' : cat\n    c.forecastAmountCredit= catObject[i].forecastAmountCredit\n    c.settledDebitCounter= catObject[i].settledDebitCounter\n    c.forecastAmountDebit= catObject[i].forecastAmountDebit\n    c.codCategory= catObject[i].codCategory\n    c.codSubCategory= catObject[i].codSubCategory;\n    c.codAccountService= catObject[i].codAccountService\n    c.unprocessedAmountDebit= catObject[i].unprocessedAmountDebit\n    c.settledCreditCounter= catObject[i].settledCreditCounter\n    c.forecastDebitCounter= catObject[i].forecastDebitCounter\n    c.category= catObject[i].category\n    c.taskId= catObject[i].idCategory\n    c.totalCategoryAmountCredit= c.taskParentId === null ? sumCredit : catObject[i].totalCategoryAmountCredit\n    c.totalCategoryAmountDebit= c.taskParentId === null ? sumDebit : catObject[i].totalCategoryAmountDebit\n\n    arrObject.push(c);\n\n    var j\n\n    for(j = 0; j < subObject.length; ++j) {\n      if(catObject[i].idCategory !== null && catObject[i].idCategory === subObject[j].idCategory) {\n        var f = {\n            \"unprocessedDebitCounter\": null,\n            \"pendingDebitCounter\": null,\n            \"pendingAmountCredit\": null,\n            \"forecastCreditCounter\": null,\n            \"kind\": null,\n            \"settledAmountDebit\": null,\n            \"unprocessedCreditCounter\": null,\n            \"unprocessedAmountCredit\": null,\n            \"codIntCategory\": null,\n            \"settledAmountCredit\": null,\n            \"pendingAmountDebit\": null,\n            \"subCategoryDescription\": null,\n            \"idCategory\": null,\n            \"pendingCreditCounter\": null,\n            \"categoryDescription\": null,\n            \"forecastAmountCredit\": null,\n            \"settledDebitCounter\": null,\n            \"forecastAmountDebit\": null,\n            \"codCategory\": null,\n            \"codSubCategory\": null,\n            \"codAccountService\": null,\n            \"unprocessedAmountDebit\": null,\n            \"settledCreditCounter\": null,\n            \"forecastDebitCounter\": null,\n            \"category\": null,\n            \"taskId\": null,\n            \"taskParentId\": null,\n        }\n\n       \t\n        f.unprocessedDebitCounter= subObject[j].unprocessedDebitCounter\n        f.pendingDebitCounter= subObject[j].pendingDebitCounter\n        f.pendingAmountCredit= subObject[j].pendingAmountCredit\n        f.forecastCreditCounter= subObject[j].forecastCreditCounter\n        f.kind= subObject[j].kind\n        f.settledAmountDebit= subObject[j].settledAmountDebit\n        f.unprocessedCreditCounter= subObject[j].unprocessedCreditCounter\n        f.unprocessedAmountCredit= subObject[j].unprocessedAmountCredit\n        f.codIntCategory= subObject[j].codIntCategory\n        f.settledAmountCredit= subObject[j].settledAmountCredit\n        f.pendingAmountDebit= subObject[j].pendingAmountDebit\n        f.subCategoryDescription= subObject[j].subCategoryDescription\n        f.idCategory= catObject[i].idCategory\n        f.pendingCreditCounter= subObject[j].pendingCreditCounter\n        // f.categoryDescription= subObject[j].categoryDescription\n        f.categoryDescription = subObject[j].subCategoryDescription\n        f.forecastAmountCredit= subObject[j].forecastAmountCredit\n        f.settledDebitCounter= subObject[j].settledDebitCounter\n        f.forecastAmountDebit= subObject[j].forecastAmountDebit\n        f.codCategory= catObject[i].codCategory\n        f.codSubCategory= subObject[j].codSubCategory\n        f.codAccountService= subObject[j].codAccountService\n        f.unprocessedAmountDebit= subObject[j].unprocessedAmountDebit\n        f.settledCreditCounter= subObject[j].settledCreditCounter\n        f.forecastDebitCounter= subObject[j].forecastDebitCounter\n        f.totalCategoryAmountCredit= subObject[j].totalCategoryAmountCredit\n        f.totalCategoryAmountDebit= subObject[j].totalCategoryAmountDebit\n        f.category= null\n        f.taskId= 0\n        f.taskParentId= catObject[i].idCategory\n\n        arrObject.push(f)\n      }\n    }\n}\n\n\nvar y\n\nfor (y = 0; y < arrObject.length; y++) {\n  if (arrObject[y].category === null || arrObject[y].category.includes('null')){\n    arrObject[y].taskId = y\n  }\n}\n\nconsole.dir(arrObject)\n\nreturn arrObject;"},"schema":[{"name":"unprocessedDebitCounter","type":"any"},{"name":"pendingDebitCounter","type":"any"},{"name":"pendingAmountCredit","type":"number"},{"name":"forecastCreditCounter","type":"any"},{"name":"kind","type":"any"},{"name":"settledAmountDebit","type":"number"},{"name":"unprocessedCreditCounter","type":"any"},{"name":"unprocessedAmountCredit","type":"number"},{"name":"codIntCategory","type":"any"},{"name":"settledAmountCredit","type":"number"},{"name":"pendingAmountDebit","type":"number"},{"name":"subCategoryDescription","type":"any"},{"name":"idCategory","type":"any"},{"name":"pendingCreditCounter","type":"any"},{"name":"categoryDescription","type":"string"},{"name":"forecastAmountCredit","type":"number"},{"name":"settledDebitCounter","type":"any"},{"name":"forecastAmountDebit","type":"number"},{"name":"codCategory","type":"string"},{"name":"codSubCategory","type":"string"},{"name":"codAccountService","type":"any"},{"name":"unprocessedAmountDebit","type":"number"},{"name":"settledCreditCounter","type":"any"},{"name":"forecastDebitCounter","type":"any"},{"name":"category","type":"string"},{"name":"totalCategoryAmountCredit","type":"number"},{"name":"totalCategoryAmountDebit","type":"number"},{"name":"taskId","type":"number"},{"name":"taskParentId","type":"any"}],"values":[]}],"parameters":[{"id":"ca358917-cb52-4f34-9de3-a141dab3b466","name":"bicParticipant","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":""},{"id":"506cddb0-667b-400d-968d-484f5b06d85e","name":"codCurrency","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"EUR"},{"id":"e6421c49-025f-40a9-b927-c238d5fe0fbf","name":"codIntCategory","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"AN1717300000811"},{"id":"473e3c9a-f8c8-4f07-90a4-75e2d48dab8c","name":"codService","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"CORR"},{"id":"3ee72ee6-fd47-482b-acb8-6e11f38f5f07","name":"counterpart","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":""},{"id":"91549cf8-9cf9-45df-931c-7b71c81077f7","name":"dateFrom","description":"","systemType":"","defaultValue":"1970-01-01T00:00:00.000Z","lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"date","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"2000-09-28T22:00:00.000Z"},{"id":"496cb79f-f923-477b-9a08-fe9ee6c84a96","name":"dateTo","description":"","systemType":"","defaultValue":"1970-01-01T00:00:00.000Z","lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"date","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":"2021-09-28T22:00:00.000Z"},{"id":"b3e397b0-983b-47ee-9c84-2918233a47db","name":"idAccount","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"number","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":null},{"id":"58bf64b4-e012-46ca-80d5-f962fb592a93","name":"codIntSubCategory","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"string","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":""}]}}