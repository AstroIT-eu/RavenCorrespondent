{"createdAt":"2021-05-24T14:24:36.754","modifiedAt":"2021-10-05T15:16:03.912","createdBy":"TAS","modifiedBy":"TAS","title":"Forecast Journal Commands","provider":"SpringBackendServiceProvider","tags":[],"systemTags":["published-as-datasource","services-editor","RESERVED_DOCUMENT"],"name":"Forecast Journal Commands","type":"services-editor","saved":true,"id":"adf7aa9b-358c-4987-adad-d1c4e65dabd5","previewId":null,"content":{"definition":{"id":"adf7aa9b-358c-4987-adad-d1c4e65dabd5","title":"Forecast Journal Commands","useBaseUrl":true,"publishAsDatasource":true,"serverSideDatasource":false,"dataEntryEnabled":false,"downloadEnabled":false,"expectedResultType":"Table","validated":true,"mandatoryParameters":[],"skipOnEmptyQueryString":false,"includeRawData":false,"emptyParametersToEmptyString":false,"schema":[{"name":"command","type":"string","value":"extendedEdit"},{"name":"enabled","type":"boolean","value":true}],"selectCall":{"method":"Get","enabled":true,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{"datasource":{},"parameter":{},"systemParameter":{},"custom":{"result":{"fields":[null]}}},"expectedResult":null,"syntax":"standard","code":"var result = toArray(custom('result'));\nvar enabled = _.map(result, function(i){\n\t\n\tvar history = true;\n \tvar detail = true;\n  \tvar edit = true;\n  \tvar copy = false;\n  \tvar cancel = false;\n  \tvar reconcileForecast = false;\n \tvar modifyReconciliation = false;\n    var viewCustomDetails = true;\n    var forceForecast = false;\n    var extendedEdit = true;\n  \n\n    if(i.indRecurring === 'N') {\n    \tcopy = true;\n    }\n  \n  \tif(i.forecastStatus !== 'CANCELLED' && i.forecastStatus !== 'REJECTED' && i.forecastStatus !== 'SETTLED' && i.forecastStatus !== 'UNMATCHED' && i.indManualUpdate === 'Y') {\n      cancel = true;\n    }\n  \n  \tif((_.isNull(i.reconciliationStatus) || i.reconciliationStatus !== 'COMPLETED') && (i.forecastStatus === 'PREADVICE' || i.forecastStatus === 'FORECAST')) {\n      reconcileForecast = true;\n    }\n  \n  \tif((i.forecastPaymentMappingCnt !== 0 && i.paymentForecastMappingCnt !== 0) && i.reconciliationStatus !== null && i.reconciliationStatus !== 'NO') {\n      modifyReconciliation = true;\n    }\n  \n    if((i.forecastPaymentMappingCnt !== 0 && i.paymentForecastMappingCnt !== 0) && i.reconciliationStatus === null || i.reconciliationStatus === 'NO' && i.forecastStatus != null) {\n      forceForecast = true;\n    }\n  \n  \tif((i.forecastStatus === 'SETTLED' && i.reconciliationStatus === 'COMPLETED') || (i.reconciliationStatus === 'NO' && i.forecastStatus === 'CANCELLED') || (i.reconciliationStatus === 'NO' && i.forecastStatus === 'UNMATCHED') || (i.reconciliationStatus === 'NO' && i.forecastStatus === 'REJECTED')) {\n   \textendedEdit = false;\n    }\n  \n/*    if((i.forecastPaymentMappingCnt !== 0 && i.paymentForecastMappingCnt !== 0) && i.reconciliationStatus === null || i.reconciliationStatus === 'NO') {\n      viewCustomDetails = false;\n    }*/\n  \n\n  \treturn [{\n      \"command\": \"history\",\n      \"enabled\": true\n    }, {\n      \"command\": \"viewDetail\",\n      \"enabled\": true\n    }, {\n      \"command\": \"edit\",\n      \"enabled\": true\n    }, {\n      \"command\": \"copy\",\n      \"enabled\": copy\n    }, {\n      \"command\": \"cancel\",\n      \"enabled\": cancel\n    }, {\n      \"command\": \"reconcileForecast\",\n      \"enabled\": reconcileForecast\n    }, {\n      \"command\": \"modifyReconciliation\",\n      \"enabled\": modifyReconciliation\n    }, {\n      \"command\": \"viewCustomDetails\",\n      \"enabled\": viewCustomDetails\n    },  {\n      \"command\": \"forceForecast\",\n      \"enabled\": forceForecast\n    },  {\n      \"command\": \"extendedEdit\",\n      \"enabled\": extendedEdit\n    }];\n\n})\n\nreturn _.flatten(enabled)"},"headers":[],"address":{"schema":{"datasource":{},"parameter":{"id":{"id":"23e49d79-196e-1c48-8f16-5fa1477aa44a"}},"systemParameter":{},"custom":{}},"expectedResult":null,"syntax":"web-template","code":"foundation/rs/forecast/<%= parameter('id') %>"},"type":"Select","errorBypass":{"schema":{},"expectedResult":null,"syntax":"standard"}},"insertCall":{"method":"Put","enabled":false,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Insert","errorBypass":{"schema":{},"expectedResult":null,"syntax":"standard"}},"updateCall":{"method":"Post","enabled":false,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Update","errorBypass":{"schema":{},"expectedResult":null,"syntax":"standard"}},"deleteCall":{"method":"Delete","enabled":false,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Delete","errorBypass":{"schema":{},"expectedResult":null,"syntax":"standard"}},"createCall":{"method":"Get","enabled":false,"serverSide":false,"serverSideUrlParametersEncoded":false,"serverSideUseCallerHeaders":false,"virtual":false,"responseType":"json","transformerOut":{"schema":{},"expectedResult":null,"syntax":"standard","code":"{}"},"transformerIn":{"schema":{},"expectedResult":null,"syntax":"standard","code":"custom('result');"},"headers":[],"address":{"schema":{},"expectedResult":null,"syntax":"web-template"},"type":"Create","errorBypass":{"schema":{},"expectedResult":null,"syntax":"standard"}},"serverSideOptions":{"id":"5d3167c2-0958-52c6-6752-5ac47748d7bd","columns":[],"rows":[],"originalRows":[],"dataEntryRunTypes":[],"datasourceType":"Standard","autoRefreshEnabled":false,"autoRefreshSystem":false,"autoRefreshTime":60,"refreshOnLoad":false,"remoteSort":"","page":1,"isBusy":false,"isFiltered":false,"isServerSide":false,"hasError":false,"splitItems":[],"rowCount":100,"pageSize":10,"tags":[],"parameters":[]},"pageExp":{"schema":{},"expectedResult":null,"syntax":"standard"},"pageSizeExp":{"schema":{},"expectedResult":null,"syntax":"standard"},"recordCountExp":{"schema":{},"expectedResult":null,"syntax":"standard"},"sortingExp":{"schema":{},"expectedResult":null,"syntax":"standard"},"downloadExp":{"schema":{},"expectedResult":null,"syntax":"web-template"},"baseUrlId":"Aquarius Services","resultTypes":"Table"},"parameters":[{"id":"23e49d79-196e-1c48-8f16-5fa1477aa44a","name":"id","description":"","systemType":"","defaultValue":null,"lookupItems":[],"isHidden":false,"isMultiSelect":false,"isReadOnly":false,"isOptional":false,"popupWidth":300,"isSearchAllowed":false,"ravenParameterType":"normal","ravenDatatype":"number","lookup":{"mode":"standard","showSearchBox":true,"allowSort":true,"bindings":[],"columns":[]},"rules":[],"tags":[],"value":10002779}]}}